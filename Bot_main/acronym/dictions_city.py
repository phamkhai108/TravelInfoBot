
city_mapping = {
    "an giang": "Tỉnh An Giang",
    "angiang": "Tỉnh An Giang",
    "bà rịa - vũng tàu": "Bà Rịa",
    "bà rịa vũng tàu": "Bà Rịa",
    "ba ria vung tau": "Bà Rịa",
    "bắc giang": "Bắc Giang",
    "bắcgiang": "Bắc Giang",
    "bac giang": "Bắc Giang",
    "bácgiang": "Bắc Giang",
    "bắc kạn": "Bắc Kạn",
    "backan": "Bắc Kạn",
    "bac kan": "Bắc Kạn",
    "bạc liêu": "Bạc Liêu",
    "bac liêu": "Bạc Liêu",
    "bacliêu": "Bạc Liêu",
    "bắc ninh": "Bắc Ninh",
    "bac ninh": "Bắc Ninh",
    "bacninh": "Bắc Ninh",
    "bến tre": "Bến Tre",
    "bentre": "Bến Tre",
    "ben tre": "Bến Tre",
    "bình định": "Bình Định",
    "binhđinh": "Bình Định",
    "binh đinh": "Bình Định",
    "bình dương": "Bình Dương",
    "binh dương": "Bình Dương",
    "binhdương": "Bình Dương",
    "bình phước": "Tỉnh Bình Phước",
    "binh phuoc": "Tỉnh Bình Phước",
    "binhphuoc": "Tỉnh Bình Phước",
    "bình thuận": "Tỉnh Bình Thuận",
    "binh thuan": "Tỉnh Bình Thuận",
    "binhthuan": "Tỉnh Bình Thuận",
    "cà mau": "Cà Mau",
    "ca mau": "Cà Mau",
    "camau": "Cà Mau",
    "cao bằng": "Cao Bằng",
    "caobang": "Cao Bằng",
    "cao bang": "Cao Bằng",
    "đà nẵng": "Đà Nẵng",
    "danang": "Đà Nẵng",
    "da nang": "Đà Nẵng",
    "đồng tháp": "Đồng Tháp",
    "dong thap": "Đồng Tháp",
    "dongthap": "Đồng Tháp",
    "gia lai": "Tỉnh Gia Lai",
    "gialai": "Tỉnh Gia Lai",
    "hà giang": "Hà Giang",
    "ha giang": "Hà Giang",
    "hagiang": "Hà Giang",
    "hà nam": "Hà Nam",
    "ha nam": "Hà Nam",
    "hanam": "Hà Nam",
    "hà nội": "Hà Nội",
    "ha nôi": "Hà Nội",
    "ha noi": "Hà Nội",
    "hanoi": "Hà Nội",
    "hà noi": "Hà Nội",
    "ha nội": "Hà Nội",
    "hà tĩnh": "Hà Tĩnh",
    "ha tinh": "Hà Tĩnh",
    "hatinh": "Hà Tĩnh",
    "hải dương": "Tỉnh Hải Dương",
    "hai duong": "Tỉnh Hải Dương",
    "haiduong": "Tỉnh Hải Dương",
    "hải phòng": "Hải Phòng",
    "hai phong": "Hải Phòng",
    "haiphong": "Hải Phòng",
    "hậu giang": "Hậu Giang",
    "haugiang": "Hậu Giang",
    "hau giang": "Hậu Giang",
    "hưng yên": "Hưng Yên",
    "hung yen": "Hưng Yên",
    "hungyen": "Hưng Yên",
    "khánh hòa": "Khánh Hòa",
    "khanh hoa": "Khánh Hòa",
    "khanhhoa": "Khánh Hòa",
    "kiên giang": "Kiên Giang",
    "kiengiang": "Kiên Giang",
    "kien giang": "Kiên Giang",
    "kon tum": "Kon Tum",
    "kontum": "Kon Tum",
    "lai châu": "Lai Châu",
    "laichau": "Lai Châu",
    "lai chau": "Lai Châu",
    "lâm đồng": "Lâm Đồng",
    "lam đong": "Lâm Đồng",
    "lamđong": "Lâm Đồng",
    "lạng sơn": "Lạng Sơn",
    "lang son": "Lạng Sơn",
    "langson": "Lạng Sơn",
    "lào cai": "Lào Cai",
    "laocai": "Lào Cai",
    "lao cai": "Lào Cai",
    "long an": "Long An",
    "longan": "Long An",
    "nam định": "Nam Định",
    "nam dinh": "Nam Định",
    "namdinh": "Nam Định",
    "nghệ an": "Tỉnh Nghệ An",
    "nghe an": "Tỉnh Nghệ An",
    "nghean": "Tỉnh Nghệ An",
    "ninh bình": "Ninh Bình",
    "ninhbinh": "Ninh Bình",
    "ninh binh": "Ninh Bình",
    "ninh thuận": "Tỉnh Ninh Thuận",
    "ninh thuan": "Tỉnh Ninh Thuận",
    "ninhthuan": "Tỉnh Ninh Thuận",
    "phú thọ": "Phú Thọ",
    "phu tho": "Phú Thọ",
    "phutho": "Tỉnh Phú Thọ",
    "phu yen": "Tỉnh Phú Yên",
    "phuyen": "Tỉnh Phú Yên",
    "phú yên": "Phú Yên",
    "quảng bình": "Tỉnh Quảng Bình",
    "quang binh": "Tỉnh Quảng Bình",
    "quangbinh": "Tỉnh Quảng Bình",
    "quảng nam": "Tỉnh Quảng Nam",
    "quang nam": "Tỉnh Quảng Nam",
    "quangnam": "Tỉnh Quảng Nam",
    "quảng ngãi": "Quảng Ngãi",
    "quangngai": "Quảng Ngãi",
    "quang ngai": "Quảng Ngãi",
    "quảng ninh": "Tỉnh Quảng Ninh",
    "quang ninh": "Tỉnh Quảng Ninh",
    "quangninh": "Tỉnh Quảng Ninh",
    "quảng trị": "Quảng Trị",
    "quangtri": "Quảng Trị",
    "quang tri": "Quảng Trị",
    "sóc trăng": "Sóc Trăng",
    "soc trang": "Sóc Trăng",
    "soctrang": "Sóc Trăng",
    "sơn la": "Sơn La",
    "sonla": "Sơn La",
    "son la": "Sơn La",
    "tây ninh": "Tỉnh Tây Ninh",
    "tayninh": "Tỉnh Tây Ninh",
    "tay ninh": "Tỉnh Tây Ninh",
    "thai binh": "Thái Bình",
    "thaibinh": "Thái Bình",
    "thái bình": "Thái Bình",
    "thái nguyên": "Tỉnh Thái Nguyên",
    "thainguyen": "Tỉnh Thái Nguyên",
    "thai nguyen": "Tỉnh Thái Nguyên",
    "thanh hóa": "Thanh Hóa",
    "thanh hoa": "Thanh Hóa",
    "thanhhoa": "Thanh Hóa",
    "thừa thiên huế": "Huế",
    "thua thien hue": "Huế",
    "thuathienhue": "Huế",
    "hue": "Huế",
    "tiền giang": "Tỉnh Tiền Giang",
    "tiengiang": "Tỉnh Tiền Giang",
    "tien giang": "Tỉnh Tiền Giang",
    "tp hồ chí minh": "Thành phố Hồ Chí Minh",
    "tp ho chi minh": "Thành phố Hồ Chí Minh",
    "tp hcm": "Thành phố Hồ Chí Minh",
    "hồ chí minh": "Thành phố Hồ Chí Minh",
    "ho chi minh": "Thành phố Hồ Chí Minh",
    "sai gon": "Thành phố Hồ Chí Minh",
    "sài gòn": "Thành phố Hồ Chí Minh",
    "saigon": "Thành phố Hồ Chí Minh",
    "sài gon": "Thành phố Hồ Chí Minh",
    "sai gòn": "Thành phố Hồ Chí Minh",
    "trà vinh": "Trà Vinh",
    "tra vinh": "Trà Vinh",
    "travinh": "Trà Vinh",
    "tuyên quang": "Tuyên Quang",
    "tuyen quang": "Tuyên Quang",
    "tuyenquang": "Tuyên Quang",
    "vĩnh long": "Vĩnh Long",
    "vinh long": "Vĩnh Long",
    "vinhlong": "Vĩnh Long",
    "vĩnh phúc": "Vĩnh Phúc",
    "vinh phuc": "Vĩnh Phúc",
    "vinhphuc": "Vĩnh Phúc",
    "yên bái": "Yên Bái",
    "yenbai": "Yên Bái",
    "yen bai": "Yên Bái",
}



# Tạo một defaultdict với giá trị mặc định là key

# Hàm chuẩn hóa văn bản "tôi yêu hanoi" -> "tôi yêu Hà Nội"
normalized_words = []
def normalize_text_city(text):
    if text is None:
        return ""
    # Chuyển tất cả thành chữ thường để so sánh
    text_lower = text.lower()
    for key, value in city_mapping.items():
        if key in text_lower:
            text_lower = text_lower.replace(key, value)  # Đảm bảo cùng một dạng chữ thường
            if value not in normalized_words:
                normalized_words.append(value)
    return text_lower

#Hàm chuẩn hóa "tôi yêu "Hà Nội" ---> "tôi yêu city"
def normalize_city(sentence):
    for key, value in city_mapping.items():
        if value in sentence:
    # for city in normalized_words:
            sentence = sentence.replace(value, "city")
    return sentence

#hàm láy ra tên thành phố trong 70 kí tự đầu tiên
def find_city(text):
    if text is None:
        return "0"
    stand = normalize_text_city(text.lower())
    first_fifty_chars = stand[:70]
    for city in normalized_words:
        if city in first_fifty_chars:
            return city
    return "0"

# text = 'thời tiết london'  # Sử dụng khóa 'HN' như một ví dụ
# p = normalize_text(text)
# print(p)
# print(normalize_city(p))
# print(find_city(p))

# a = "Bắc giang"
# # b = a.title()
# print(normalize_city(a.title()))

